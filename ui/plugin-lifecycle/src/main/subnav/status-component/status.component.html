<vcd-loading-indicator [isLoading]="isLoading" [showSpinner]="isLoading" [fixed]="true"></vcd-loading-indicator>

<div class="list-all-plugins">
    <h1>Plugins</h1>
    <clr-datagrid [(clrDgSelected)]="selected">
        <clr-dg-action-bar>
            <div class="btn-group last">
                <button type="button" class="btn btn-sm btn-outline" (click)="onUpload()">
                    <clr-icon shape="upload-cloud"></clr-icon>
                    Upload
                </button>
            </div>

            <div class="btn-group" *ngIf="selected.length > 0">
                <button type="button" class="btn btn-sm btn-link" (click)="onDisable()">Disable</button>
                <button type="button" class="btn btn-sm btn-link" (click)="onEnable()">Enable</button>
                <button type="button" class="btn btn-sm btn-link" (click)="onDelete()">Delete</button>

                <clr-dropdown>
                    <button type="button" class="btn btn-sm btn-link" clrDropdownTrigger>
                        Scope Actions
                        <clr-icon shape="caret down"></clr-icon>
                    </button>
                    <clr-dropdown-menu clrPosition="bottom-right" *clrIfOpen>
                        <label class="dropdown-header">Change Scope</label>
                        <button clrDropdownItem type="button" (click)="publishForAllTenants()">Publish For All Tenants</button>
                        <button clrDropdownItem type="button" (click)="unpublishForAllTenants()">Unpublish For All Tenants</button>
                        <div class="dropdown-divider"></div>
                        <button clrDropdownItem type="button" (click)="openChangeOrgScope('publish')">Publish</button>
                        <button clrDropdownItem type="button" (click)="openChangeOrgScope('unpublish')">Unpublish</button>
                        <div class="dropdown-divider"></div>
                        <button clrDropdownItem type="button" (click)="changeScope()">Change Scope</button>
                    </clr-dropdown-menu>
                </clr-dropdown>
            </div>
        </clr-dg-action-bar>

        <!-- PLACEHOLDER -->
        <clr-dg-placeholder>We couldn't find any plugins...</clr-dg-placeholder>
        <!-- END PLACEHOLDER -->

        <clr-dg-column>Name</clr-dg-column>
        <clr-dg-column>Vendor</clr-dg-column>
        <clr-dg-column>Version</clr-dg-column>
        <clr-dg-column>Description</clr-dg-column>
        <clr-dg-column>Tenant Scoped</clr-dg-column>
        <clr-dg-column>Provider Scoped</clr-dg-column>
        <clr-dg-column>Available</clr-dg-column>

        <clr-dg-row *clrDgItems="let plugin of plugins" [clrDgItem]="plugin">
            <clr-dg-cell>{{ plugin.pluginName }}</clr-dg-cell>
            <clr-dg-cell>{{ plugin.vendor }}</clr-dg-cell>
            <clr-dg-cell>{{ plugin.version }}</clr-dg-cell>
            <clr-dg-cell>{{ plugin.description }}</clr-dg-cell>
            <clr-dg-cell>{{ plugin.tenantScoped }}</clr-dg-cell>
            <clr-dg-cell>{{ plugin.providerScoped }}</clr-dg-cell>
            <clr-dg-cell>{{ plugin.enabled }}</clr-dg-cell>
        </clr-dg-row>
    </clr-datagrid>
</div>

<div class="plugins-modal">
    <clr-modal [(clrModalOpen)]="modal.opened" [clrModalClosable]="false">
        <vcd-alert [alertMessage]="alertMessage" [alertClasses]="alert-info"></vcd-alert>

        <h3 class="modal-title">{{ modal.title }}</h3>
        <div class="modal-body">
            <p *ngIf="modal.body">{{ modal.body }}</p>
        </div>
        <div class="modal-footer">
            <button *ngIf="modal.decline" type="button" class="btn btn-primary" (click)="emitAndClose(false)">
                {{ modal.decline }}
            </button>
            <button *ngIf="modal.accept" type="button" class="btn btn-primary" (click)="emitAndClose(true)">
                {{ modal.accept }}
            </button>
        </div>
    </clr-modal>
</div>

<!-- Change org scope -->
<vcd-change-org-scope [(state)]="changeScopeState" [action]="action"></vcd-change-org-scope>
<!-- Upload new plugin -->
<vcd-plugin-upload [(open)]="wantToUpload"></vcd-plugin-upload>
<!-- Trakc org scope change request -->
<vcd-change-org-scope-tracker [(open)]="showTracker"></vcd-change-org-scope-tracker>
<!-- Change scope -->
<vcd-change-scope [(open)]="openChangeScope"></vcd-change-scope>
<!--  Show error messages -->
<vcd-error-notifyer [(opened)]="openErrorNotifyer">
    <p>{{ errorMessage }}</p>
</vcd-error-notifyer>